{
  "builders": [{
    "type": "amazon-ebs",
    "profile": "mgmt",
    "vpc_id": "vpc-d55f14b2",
    "region": "ap-southeast-2",
    "source_ami": "ami-00a5fc80ec944398f",
    "instance_type": "t2.micro",
    "ssh_username": "admin",
    "ami_name": "packer-jenkins-debian9-ami-image-{{timestamp}}"
  }],

  "provisioners": [

    {
        "type": "shell",
        "inline": [
           "echo `pwd`, `whoami`", 
           "sudo apt-get update",
           "sudo apt-get install -y software-properties-common python-pip git default-jdk",
           "curl -o docker.gpg https://download.docker.com/linux/debian/gpg",
           "sudo apt-key add docker.gpg",
           "sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/debian $(lsb_release -cs) stable\"",
           "sudo apt-get update",
            "sudo apt-get install -y docker-ce",
            "sudo systemctl enable docker",
            "sudo systemctl start docker",
            "sudo docker pull qriousasset/jdk-mvn-py-node",
            
            "sudo usermod -aG docker admin"
        ]
    },

    {
      "type": "shell",
      "inline": [
        "rm .ssh/authorized_keys ; sudo rm /root/.ssh/authorized_keys"
      ]
    }


  ]
}
